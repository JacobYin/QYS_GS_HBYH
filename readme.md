# 契约锁对接浪潮系统梗概

要做到业务系统能够与契约锁系统进行对接，我们首先确定数据流程是怎样的，根据契约锁实施团队提供的实施方案，制订了如下的数据流程图：
![](https://qiyuesuo-dl.oss-cn-hangzhou.aliyuncs.com/open/%E4%B8%9A%E5%8A%A1%E5%88%86%E7%B1%BB%E5%8F%91%E8%B5%B7%E6%B5%81%E7%A8%8B%EF%BC%88UML%EF%BC%89.png)

**由此数据流程图及契约锁提供的接口文档，我们可以确定数据获取推送流程的顺序，步骤是：**

### 1. 首先获取浪潮系统里每一个合同关联的附件信息，通过存储过程查询到附件信息后，找到合同附件存储路径，用契约锁提供的读取文件代码将合同附件文件读取上传到契约锁；
### 
### 2. 契约锁获取到合同附件内容后调用通过文件生成合同文档接口，返回合同文档ID；
### 
### 3. 如果有多个附件需要进行盖章操作，那么代码会将查询到符合盖章条件的所有附件都去调用通过文件生成合同文档接口，然后把每一个附件调用接口返回的文档id（documentId）存进一个list数组里，把这些信息进行暂存；
### 
### 4. 通过存储过程读取浪潮系统的合同信息，提取契约锁创建合同接口所需要的信息后，将这些信息封装转换为JSON，其中创建合同的document参数（附件信息参数）通过读取上一步存的list数组里面的documentId来传递。之后调用发送创建合同接口。
